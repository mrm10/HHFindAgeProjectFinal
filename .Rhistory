leaps.realf = leaps(X,y,names=names(mlb.f)[-1])
min(leaps.realf$Cp)
kf = length(leaps.realf$Cp)
namess = leaps.realf$which[(1:kf)[leaps.realf$Cp==min(leaps.realf$Cp)],]
names(mlb.f)[-1][c(namess)]
plot(leaps.realf$size,leaps.realf$Cp)
XnoL = mlb.fremoveL[,-1]
ynoL = mlb.fremoveL[,1]
leaps.realfnoL = leaps(XnoL,ynoL,names=names(mlb.fremoveL)[-1])
min(leaps.realfnoL$Cp)
kfnoL = length(leaps.realfnoL$Cp)
namessnoL = leaps.realfnoL$which[(1:kf)[leaps.realfnoL$Cp==min(leaps.realfnoL$Cp)],]
names(mlb.fremoveL)[-1][c(namessnoL)]
plot(leaps.realfnoL$size,leaps.realfnoL$Cp)
mlb.b = read.delim(file.choose())
View(mlb.b)
mlb.s = read.delim(file.choose())
mlb.s = mlb.s[,-c(1:2)]
View(mlb.s)
mlb.f = cbind(mlb.f,mlb.s)
View(mlb.f)
alias(lm(W~.,data=mlb.f))
mlb.f2 = read.delim(file.choose())
mlb.f3 = cbind(mlb.f2,mlb.s)
alias(lm(W~.,data=mlb.f3))
lmf = lm(W~.,data=mlb.f)
summary(lmf)
Salary = mlb.s
lmf = lm(W~.,data=mlb.f)
lmf
mlb.f = cbind(mlb.f[,-c(13)],Salary)
View(mlb.f)
lmf = lm(W~.,data=mlb.f)
lmf
summary(lmf)
lmstepf = step(lmf)
mlb.fremoveL = mlb.f[,-c(2)]
View(mlb.fremoveL)
lmfnoL = lm(W~.,data=mlb.fremoveL)
summary(lmfnoL)
lmfnoL
lmstepfnoL = step(lmfnoL)
lmstepf2 = step(lmstepf,.~.^2)
anova(lmstepf2)
lmstepf3 = update(lmstepf2,.~.-SSB)
anova(lmstepf3)
lmstepf4 = update(lmstepf3,.~.-SBPCT)
anova(lmstepf4)
lmstepf5 = update(lmstepf4,.~.-League:SBPCT)
anova(lmstepf5)
lmstepf6 = update(lmstepf5,.~.-SCS)
anova(lmstepf6)
lmstepf7 = update(lmstepf6,.~.-League)
anova(lmstepf7)
lmstepf8 = update(lmstepf7,.~.-C.WP)
anova(lmstepf8)
lmstepfnoL2 = step(lmstepfnoL,.~.^2)
anova(lmstepfnoL2)
lmfnoL
lmstepfnoL3 = update(lmstepfnoL2,.~.-SSB)
anova(lmstepfnoL3)
lmstepfnoL4 = update(lmstepfnoL3,.~.-SCS)
anova(lmstepfnoL4)
lmstepfnoL5 = update(lmstepfnoL4,.~.-SBPCT)
anova(lmstepfnoL5)
lmstepfnoL6 = update(lmstepfnoL5,.~.-TC)
anova(lmstepfnoL6)
lmstepfnoL7 = update(lmstepfnoL6,.~.-A)
anova(lmstepfnoL7)
X = mlb.f[,-1]
y = mlb.f[,1]
leaps.realf = leaps(X,y,names=names(mlb.f)[-1])
min(leaps.realf$Cp)
kf = length(leaps.realf$Cp)
namess = leaps.realf$which[(1:kf)[leaps.realf$Cp==min(leaps.realf$Cp)],]
names(mlb.f)[-1][c(namess)]
plot(leaps.realf$size,leaps.realf$Cp)
XnoL = mlb.fremoveL[,-1]
ynoL = mlb.fremoveL[,1]
leaps.realfnoL = leaps(XnoL,ynoL,names=names(mlb.fremoveL)[-1])
min(leaps.realfnoL$Cp)
kfnoL = length(leaps.realfnoL$Cp)
namessnoL = leaps.realfnoL$which[(1:kf)[leaps.realfnoL$Cp==min(leaps.realfnoL$Cp)],]
names(mlb.fremoveL)[-1][c(namessnoL)]
plot(leaps.realfnoL$size,leaps.realfnoL$Cp)
mlb.bf = cbind(mlb.f,mlb.b[,-c(1:2,17,25:27)])
View(mlb.bf)
alias(lm(W~.,data=mlb.bf))
mlb.bf = mlb.bf[-c(36,35,34,33,32,31)]
View(mlb.bf)
lmbf = lm(W~.,data=mlb.bf)
lmbf
summary(lmbf)
names(mlb.f[-1])[c(namess)]
lmleapsf = lm(W~INN+DP,data=mlb.f)
summary(lmleapsf)
anova(lmstepf8)
anova(lmstepf6)
anova(lmstepf4)
anova(lmstepf5)
anova(lmstepf6)
anova(lmstepf4)
anova(lmleapsf)
lmfnoL
names(mlb.fremoveL)[-1][c(namessnoL)]
lmleapsfnoL = lm(W~INN+DP,data=mlb.fremoveL)
summary(lmleapsfnoL)
lmfnoL
attach(mlb.f)
attach(mlb.bf)
summary(lmf)
lmstepf
step(lmf)
step(lmfnoL)
mlb.5 = read.delim(file.choose())
mlb.6 = read.delim(file.choose())
mlb.7 = read.delim(file.choose())
mlb.8 = read.delim(file.choose())
mlb.s2-14 = mlb.8[c(2)]
mlb.s2014 = mlb.8[c(2)]
mlb.b2014 = cbind(mlb.5,mlb.s2014)
mlb.p2014 = cbind(mlb.6,mlb.s2014)
mlb.f2014 = cbind(mlb.7[-15],mlb.s2014)
leapsbinfnoL = predict(lmleapsfnoL,new=mlb.f2014)
View(leapsbinfnoL)
lbindiffnoLf = leapsbinfnoL - mlb.f2014[,1]
mean(lbindiffnoLf)
sd(lbindiffnoLf)
leapsbinf = predict(lmleapsf,new=mlb.f2014)
lbindifff = leapsbinf - mlb.f2014[,1]
mean(lbindifff)
sd(lbindifff)
lmleapsf2
lmleapsfnoL2
lmleapsfnoL
anova(lmleapsfnoL)
lmleapsfnoL2 = update(lmleapsfnoL,~.~-DP)
lmleapsfnoL = lm(W~INN+DP,data=mlb.fremoveL)
lmleapsfnoL
anova(lmleapsfnoL)
anova(lmstepfnoL7)
update(lmleapsf,.~.-DP)
lmleapsf2 = update(lmleapsf,.~.-DP)
lmleapsf2pa = predict(lmleapsf2,new=mlb.f2014)
lfdiffpa = lmleapsf2pa - mlb.f2014[,1]
mean(lfdiffpa)
sd(lfdiffpa)
sd(lmleapsf2pa) - sd(mlb.f2014[,1])
sd(leapsbinf) - sd(mlb.f2014[,1])
sd(leapsbinfnoL) - sd(mlb.f2014[,1])
lmleapsfnoL2 = update(lmleapsfnoL,.~.-DP)
lmleapsfnoL2pa = predict(lmleapsfnoL2,new=mlb.f2014)
lmdiff2pa = lmleapsfnoL2pa - mlb.f2014[,1]
mean(lfdiff2pa)
mean(lmdiff2pa)
sd(lmdiff2pa)
sd(lmleapsfnoL2pa) - sd(mlb.f2014[,1])
anova(lmstepfnoL7)
stepfinalnoL = lm(W~INN,data=mlb.fremoveL)
stepfinalnoL
predsfnoL = predict(stepfinalnoL,new=mlb.f2014)
sfnoLdiff = predsfnoL - mlb.f2014[,1]
mean(sfnoLdiff)
sd(sfnoLdiff)
sd(predsfnoL) - sd(mlb.f2014[,1])
anova(lmstepf10)
stepfinal = lm(W~INN,data=mlb.f)
stepfinal
predsfL = predict(stepfinal,new=mlb.f2014)
sfdiff = predsfL - mlb.f2014[,1]
mean(sfdiff)
sd(sfdiff)
sd(predsfL) - sd(mlb.f2014[,1])
stepfinalnoL = lm(W~INN,data=mlb.fremoveL)
View(mlb.f)
finney = read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/finney.txt")
library(gam)
data(finney)
attach(finney)
data(finney)
View(finney)
data(kyphosi)
data(kyphosis)
View(kyphosis)
finney$vasoconstriction = as.numeric(finney$finney)
finney$vasoconstriction = as.numeric(finney$vasoconstriction)
f$v = as.numeric(finney$vasoconstriction)
finney$vasoconstriction = as.numeric(finney$vasoconstriction)
View(finney$vasoconstriction)
finney$vasoconstriction = as.numeric(finney$vasoconstriction)-1
View(finney$vasoconstriction)
finney$vasoconstriction = as.numeric(finney$vasoconstriction)-1
with(finney,scatter.smooth(vasocontriction~rate))
with(finney,scatter.smooth(vasoconstriction~rate))
View(finney)
finney$vasoconstriction = as.numeric(finney$vasoconstriction)
View(finney)
finney = read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/finney.txt")
View(finney)
finney$disease = as.numeric(finney$vasoconstriction)
View(finney$disease)
finney$disease = as.numeric(finney$vasoconstriction)-1
View(finney$disease)
View(finney)
data(kyphosis)
kyphosis$disease = as.numeric(kyphosis$Kyphosis)-1
View(kyphosis)
with(kyphosis,scatter.smooth(disease~Number))
with(kyphosis,scatter.smooth(disease~Number),span=.5)
with(finney,scatter.smooth(disease~rate))
with(finney,scatter.smooth(disease~volume))
vs1 = glm(Vasoconstriction~rate+volume,data=finney,family=binomial)
vs1 = glm(vasoconstriction~rate+volume,data=finney,family=binomial)
summary(vs1)
probs = predict(vs1,type="response")
with(finney,scatter.smooth(probs~rate))
with(finney,scatter.smooth(probs~volume))
plot.gam(vs1,residuals=TRUE)
newrate = .5:3.75
newvol = seq(0,4,.25)
grid = expand.grid(rate=newrate,volume=newvol)
dim(grid)
prob1 = predict(vs1,new=grid,type="response")
dim(prob1)
View(prob1)
View(newrate)
View(newvol)
prob1 = matrix(prob1,4,17)
contour(newrate,newvol,prob1,xlab="Rate",ylab="Volume")
with(finney,text(jitter(Rate),Volume,disease,col=disease+1))
contour(newrate,newvol,prob1,xlab="rate",ylab="volume")
with(finney,text(jitter(rate),volume,disease,col=disease+1))
table(round(probs),finney$vasoconstriction)
table(round(probs+.1),finney$vasoconstriction)
table(round(probs+.2),finney$vasoconstriction)
table(round(probs+.3),finney$vasoconstriction)
table(round(probs+.4),finney$vasoconstriction)
plot.gam(vs1,residuals=TRUE)
plot.gam(vs1,terms="rate",residuals=TRUE)
plot.gam(vs1,terms="volume",residuals=TRUE)
with(finney,text(jitter(rate),volume,disease,col=disease+1))
contour(newrate,newvol,prob1,xlab="rate",ylab="volume")
with(finney,text(jitter(rate),volume,disease,col=disease+1))
glm1 = glm(finney~.,data=finney,family=binomial)
finney = read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/finney.txt")
summary(finney)
glm1 = glm(finney~.,data=finney,family=binomial)
glm1 = glm(vasoconstriction~.,data=finney,family=binomial)
summary(glm1)
new2 = expand.grid(rate=0:4,volume=0:4)
preds2 = predict(glm1,newdata=new2,type="response")
View(preds2)
plot(preds2[new2$rate]~new2$volume)
default=read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/Default.txt")
glm4=glm(default~.,data=default,family=binomial)
glm5=update(glm4,.~.-income)
new=expand.grid(student=c("No","Yes"),income=30000,balance=0:3000)
preds=predict(glm2,newdata=new,type="response")
preds=predict(glm5,newdata=new,type="response")
View(preds)
plot(preds2[new2$rate=="Yes"]~new2$volume[new2$rate=="Yes"],type="1",ylab="Probability",xlab="volume")
plot(preds[new$student=="Yes"]~new$balance[new$student=="Yes"],
type="l",ylab="Probability",xlab="Balance")
View(default)
View(new2)
View(grid)
plot(preds2[new2$rate=="0"]~new2$volume[new2$rate=="0"],type="1",ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="0"]~new2$volume[new2$rate=="0"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="1"]~new2$volume[new2$rate=="0"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="2"]~new2$volume[new2$rate=="0"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="3"]~new2$volume[new2$rate=="0"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="4"]~new2$volume[new2$rate=="0"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="4"]~new2$volume[new2$rate=="4"],ylab="Probability",xlab="volume")
plot(preds2[new2$rate=="4"]~new2$volume[new2$rate=="4"],ylab="Probability",xlab="volume")
CES = read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/ces.txt")
attach(CES)
View(CES)
plot(energy.cons~avg.temp)
plot(sqrt(energy.cons)~avg.temp)
plot(log(energy.cons)~avg.temp)
library(MASS)
lm3 = lm(energy.cons~avg.temp)
summary(lm3)
lm3 = lm(log(energy.cons)~avg.temp)
lm4 = lm(log(energy.cons)~avg.temp)
summary(lm4)
lm5 = lm(sqrt(energy.cons)~avg.temp)
summary(lm5)
boxcox(lm3)
lm3 = lm(energy.cons~avg.temp)
boxcox(lm3)
locator()
locator()
lmbc = lm((I(energy.cons)^.6)~avg.temp)
summary(lmbc)
plot((I(energy.cons)^.6)~avg.temp)
lm3 = lm(energy.cons~avg.temp)
cor(avg.temp,energy.cons)
plot(resid(lm3)~avg.temp)
fit = lm(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
plot(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
summary(fit)
plot(resid(fit)~avg.temp[avg.temp<65])
fit2 = lm(energy.cons[avg.temp>65]~avg.temp[avg.temp>65])
summary(fit2)
plot(resid(fit2)~avg.temp[avg.temp>65])
plot(energy.cons[avg.temp>65]~avg.temp[avg.temp>65])
plot(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
anova(fit,fit2)
fit3 = lm(energy.cons~avg.temp[avg.temp>65])
fit
fit2
fit3 = lm(energy.cons~avg.temp[avg.temp>65]+avg.temp[avg.temp<65])
lm.fita65 = lm(energy.cons~avg.temp,subset=avg.temp<65)
lm.fita65 = lm(energy.cons~avg.temp,subset=avg.temp>65)
lm.fitb65 = lm(energy.cons~avg.temp,subset=avg.temp<65)
lm.fitb65
anova(lm.fita65,lm.fitb65)
plot.gam(vs1)
plot.gam(vs1,residuals=T)
with(finney,text(jitter(rate),volume,disease,col=disease+1))
lmbf = lm(Pct.BF~Weight+Height+Waist,data=bodyfat)
summary(lmbf)
residuals(lmbf)
sum(residuals(lmbf))
lmbf = lm(Pct.BF~Weight+Height+Waist-1,data=bodyfat)
summary(lmbf)
sum(residuals(lmbf))
with(finney,text(jitter(rate),volume,disease,col=disease+1))
fit
plot(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
plot(energy.cons[avg.temp>65]~avg.temp[avg.temp>65])
summary(fit)
lmbfayyy = lm(Pct.BF~Weight+Height+Waist,data=bodyfat)
sum(residuals(lmbfayyy))
contour(newrate,newvol,prob1,xlab="rate",ylab="volume")
with(finney,text(jitter(rate),volume,disease,col=disease+1))
finney$disease = as.numeric(finney$vasoconstriction)-1
contour(newrate,newvol,prob1,xlab="rate",ylab="volume")
with(finney,text(jitter(rate),volume,disease,col=disease+1))
finney = read.delim("http://sites.williams.edu/rdeveaux/files/2014/09/finney.txt")
finney$disease = as.numeric(finney$vasoconstriction)-1
View(finney$disease)
with(kyphosis,scatter.smooth(disease~Number),span=.5)
with(finney,scatter.smooth(disease~rate))
with(finney,scatter.smooth(disease~volume))
vsall= glm(vasoconstriction~rate+volume,data=finney,family=binomial)
vs1all= glm(vasoconstriction~rate+volume,data=finney,family=binomial(link=logit))
summary(vsall)
summary(vs1all)
dim(prob1)
prob1 = matrix(prob1,4,17)
contour(newrate,newvol,prob1,xlab="Rate",ylab="Volume")
newrate
newrate = .5:3.75
newrate
newrate=0:4
newrate
newvol = seq(0,4,.25)
grid = expand.grid(rate=newrate,volume=newvol)
dim(grid)
newrate = .5:3.75
newvol = seq(0,4,.25)
grid = expand.grid(rate=newrate,volume=newvol)
dim(grid)
newrate = .5:4
newrate
newrate=0:4
newvol = seq(0,4,.5)
grid = expand.grid(rate=newrate,volume=newvol)
dim(grid)
newvol
newrate
prob1 = predict(vsall,new=grid,type="response")
View(prob1)
prob1 = matrix(prob1,5,9)
View(prob1)
contour(newrate,newvol,prob1,xlab="Rate",ylab="Volume")
contour(newrate,newvol,prob1,xlab="rate",ylab="volume")
with(finney,text(jitter(rate),volume,disease,col=disease+1))
table(round(probs),finney$vasoconstriction)
probs
finney$vasoconstriction
vs3 = glm(vasoconstriction~rate+poly(volume,2),family=binomial,data=finney)
probs3 = predict(vs3,type="response")
View(probs3)
prob1 = predict(vsall,new=grid,type="response")
View(prob1)
View(finney)
plot(energy.cons~avg.temp)
plot(sqrt(energy.cons)~avg.temp)
plot(log(energy.cons)~avg.temp)
lm3 = lm(energy.cons~avg.temp)
summary(lm3)
lm3 = lm(log(energy.cons)~avg.temp)
lm3 = lm(energy.cons~avg.temp)
lm4 = lm(log(energy.cons)~avg.temp)
summary(lm4)
lm5 = lm(sqrt(energy.cons)~avg.temp)
summary(lm5)
boxcox(lm3)
lmbc = lm((I(energy.cons)^.6)~avg.temp)
summary(lmbc)
plot((I(energy.cons)^.6)~avg.temp)
cor(avg.temp,energy.cons)
plot(resid(lm3)~avg.temp)
scatter.smooth(resid(lm3)~avg.temp)
fit = lm(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
plot(energy.cons[avg.temp<65]~avg.temp[avg.temp<65])
summary(fit)
plot(resid(fit)~avg.temp[avg.temp<65])
scatter.smooth(resid(fit)~avg.temp[avg.temp<65])
fit2 = lm(energy.cons[avg.temp>65]~avg.temp[avg.temp>65])
summary(fit2)
plot(resid(fit2)~avg.temp[avg.temp>65])
scatter.smooth(resid(fit2)~avg.temp[avg.temp>65])
ttest = (-2.01257 - .04534)/(sqrt(.01679^2 + .05068^2))
ttest
df = 1000-2
2*pt(-38.54571,998)
0405 = read.delim("https://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/williams/inst/faculty/pdf%20data/catalog0405-sub.txt?root=williams")
read.delim(file.choose())
1314 = read.delim(file.choose())
read.delim(file.choose())
1314 = read.delim(file.choose())
dd = read.delim(file.choose())
with(dd,hist(Age))
with(dd,hist(B.A.to.Terminal))
with(dd,mean(Age))
mean(Age)
sum(Age,data=dd)
with(dd,Age)
with(dd,sum(Age))
dd1 = with(dd,na.omit(Age))
View(dd1)
sum(dd1)
mean(dd1)
dd2 = read.delim(file.choose())
View(dd2)
dd2 = with(dd2,na.omit(Year.of.BA,Department,Year.of.Terminal,Age,B.A.to.Terminal))
View(dd2)
dd2 = read.delim(file.choose())
View(dd2)
dd3 = dd2[,3:4]
View(dd3)
dd3 = dd2[,3,5]
View(dd3)
dd3 = dd2[,3:5]
dd3 = dd3[,-4]
View(dd3)
dd3 = dd2[,3:5]
View(dd3)
dd4 = dd3[,-4]
View(dd4)
dd4 = dd3[,-2]
View(dd4)
hist(dd4)
hist(Age,data=dd4)
with(dd4,hist(Age))
with(dd4,hist(Age),Department=MATH)
with(dd4,hist(Age),Department=MATH)
with(dd4,plot(Age))
with(dd2,plot(Gender,Age))
with(dd2,plot(Department,Age))
hist(Department~Age,data=dd2)
Age1 = with(dd2,na.omit(Age))
TenEleven = dd2[,-5]
TenEleven = cbind(TenEleven,Age1)
View(TenEleven)
with(dd2,View(Age))
TenEleven = dd2[-371,]
View(TenEleven)
TenEleven1 = TenEleven[-146,]
hist(Department~Age,data=TenEleven1)
with(dd2,cor(Year.of.BA,Age))
Fac45 = read.delim(file.choose())
Fac56 = read.delim(file.choose())
Fac67 = read.delim(file.choose())
Fac78 = read.delim(file.choose())
Fac89 = read.delim(file.choose())
Fac910 = read.delim(file.choose())
Fac1011 = read.delim(file.choose())
Fac1112 = read.delim(file.choose())
Fac1213 = read.delim(file.choose())
Fac1314 = read.delim(file.choose())
library(devtools)
create("Matt-Morris-Hutchin-Hill-Capital-Project")
create("MattMorris18")
getwd()
create("cats")
library("devtools")
library(roxygen2)
create("cats")
setwd("./cats")
document()
document()
document()
document()
library(methods)
document()
document()
setwd("./cats")
getwd
setwd("..")
install("cats")
library(devtools)
install.packages("mrm10/HHFindAgeProjectFinal")
library("roxygen2", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
install.packages("mrm10/HHFindAgeProjectFinal")
getwd()
setwd("~/FinalProject2/HHFindAge")
install.packages("mrm10/HHFindAgeProjectFinal")
